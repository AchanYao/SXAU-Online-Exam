webpackJsonp([21],{mMFB:function(t,e){},xOEA:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("gRE1"),o=n.n(a),i=n("XPYn"),l={data:function(){return{isDev:null,downloadLoading:!1,tableDataLoading:!1,tableData:[],filename:"",autoWidth:!0,refresh:!0,percentageNum:100,timer:0,updateTime:"",currentPage:1,totalPage:1,pageSize:5,keyword:""}},methods:{_getTable:function(){var t=this;this.tableDataLoading=!0,Object(i.d)(this.keyword).then(function(e){t.tableData=e.data}).finally(function(){t.tableDataLoading=!1})},handleDownload:function(){var t=this;this.downloadLoading=!0,n.e(24).then(n.bind(null,"zWO4")).then(function(e){var n=t.tableData,a=t.formatJson(["影片","上映天数","累计票房","实时票房","票房占比","排片占比","上座率","排座占比","场次","人次","场均人次","场均收入","平均票价"],n);e.export_json_to_excel({header:["影片","上映天数","累计票房","实时票房","票房占比","排片占比","上座率","排座占比","场次","人次","场均人次","场均收入","平均票价"],data:a,filename:t.filename||"excel-list",autoWidth:t.autoWidth}),t.downloadLoading=!1})},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return"影片"===t?e.movieName:e[t]})})},formatMovieData:function(t){t.forEach(function(t){o()(t.attribute).forEach(function(e,n,a){t[e.attrName]=e.attrValue})})},handleDelete:function(t,e){this.$message({message:"index: "+t+", id: "+e.id,type:"info"})},handleSearch:function(){var t=this;null!==this.keyword&&0!==this.keyword.trim().length?(this.tableDataLoading=!0,this.downloadLoading=!0,Object(i.d)(this.keyword.trim()).then(function(e){t.tableData=e.data}).finally(function(){t.tableDataLoading=!1,t.downloadLoading=!1})):this._getTable()},confirmDelete:function(t){var e=this;this.$confirm("删除班级可能会导致无法预料的问题, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.c)(t).then(function(){e.$message({type:"success",message:"删除成功!"}),e._getTable()})})},confirmChange:function(t){var e=this;this.$confirm("是否修改该班级?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(function(){Object(i.e)(t).then(function(){e.$message({type:"success",message:"修改成功!"}),e._getTable()})})},addClasses:function(){var t=this;this.$prompt("请输入班级名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputErrorMessage:"输入格式不正确",inputPattern:/\S*/}).then(function(e){var n=e.value;t.classNameValidator(n)?Object(i.a)(n).then(function(){t.$message.success("操作成功"),t._getTable()}):t.$message.warning("非法输入")}).catch(function(){t.$message({type:"info",message:"取消输入"})})},classNameValidator:function(t){return void 0!==t&&null!==t&&t.length>=4}},mounted:function(){this._getTable()},watch:{currentPage:{handler:function(t,e){this._getTable()},immediate:!0}}},r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("el-row",{staticClass:"row-bg",attrs:{justify:"start",type:"flex"}},[n("el-col",{attrs:{lg:8,md:20}},[n("el-input",{attrs:{autosize:"",placeholder:"关键字搜索，只支持学号班级姓名","prefix-icon":"el-icon-search"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),t._v(" "),n("el-col",{attrs:{lg:2,md:2}},[n("el-button",{staticStyle:{margin:"0 0 10px 10px"},attrs:{loading:t.downloadLoading,icon:"document",type:"primary"},on:{click:t.handleSearch}},[t._v("搜索\n      ")])],1),t._v(" "),n("el-col",{attrs:{lg:2,md:1,sm:1}},[n("el-button",{staticClass:"timer",attrs:{icon:"el-icon-refresh",type:"text"},on:{click:t._getTable}},[t._v("重置搜索")])],1),t._v(" "),n("el-col",{attrs:{lg:2,md:1,offset:8,sm:1}},[n("el-button",{staticClass:"timer",attrs:{icon:"el-icon-plus",round:"",type:"success"},on:{click:t.addClasses}},[t._v("新增班级")])],1)],1),t._v(" "),n("el-container",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableDataLoading,expression:"tableDataLoading"}],staticStyle:{margin:".5rem"},attrs:{data:t.tableData}},[n("el-table-column",{attrs:{label:"id",prop:"id",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{label:"班级",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{on:{input:function(t){e.row.changed=!0}},model:{value:e.row.name,callback:function(n){t.$set(e.row,"name","string"==typeof n?n.trim():n)},expression:"scope.row.name"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return t.confirmDelete(e.row.id)}}},[t._v("删除\n          ")]),t._v(" "),n("el-button",{attrs:{disabled:!e.row.changed,size:"mini",type:"success"},on:{click:function(n){return t.confirmChange(e.row)}}},[t._v("\n            保存修改\n          ")])]}}])})],1)],1)],1)},staticRenderFns:[]};var s=n("VU/8")(l,r,!1,function(t){n("mMFB")},"data-v-05c37078",null);e.default=s.exports}});
//# sourceMappingURL=21.a3f2985b25386a6852bf.js.map